import*as o from"mathjs";var m=(t,n)=>!Array.isArray(t)||!Array.isArray(n)?o.multiply(t,n):t.map((e,r)=>e*n[r]),x=t=>t.map(n=>Math.floor(n)),M=(t,n)=>t.map((e,r)=>n[r]<=e?0:1),z=t=>t.map(n=>n-Math.floor(n*(1/289))*289),$=t=>(t=t.map(n=>(n*34+1)*n),z(t)),K=t=>t.map(n=>1.79284291400159-.85373472095314*n),J=t=>{let n=[.16666666666666666,.3333333333333333],e=[0,.5,1,2],r=x(o.add(t,o.dot(t,[n[1],n[1],n[1]]))),s=o.add(o.subtract(t,r),o.dot(r,[n[0],n[0],n[0]])),c=M([s[1],s[2],s[0]],[s[0],s[1],s[2]]),a=o.subtract(1,c),i=o.min([[c[0],c[1],c[2]],[a[2],a[0],a[1]]],0),p=o.max([[c[0],c[1],c[2]],[a[2],a[0],a[1]]],0),y=o.add(o.subtract(s,i),[n[0],n[0],n[0]]),f=o.add(o.subtract(s,p),[n[1],n[1],n[1]]),g=o.subtract(s,[e[1],e[1],e[1]]),h=$(o.add(r[2],[0,i[2],p[2],1])),d=$(o.add(o.add(h,r[1]),[0,i[1],p[1],1])),k=$(o.add(o.add(d,r[0]),[0,i[0],p[0],1])),u=[.285714285714286,-.928571428571428,.142857142857143],O=o.subtract(k,m(49,x(m(k,u[2]*u[2])))),H=x(m(O,u[2])),W=x(o.subtract(O,m(7,H))),E=o.add(m(H,u[0]),[u[1],u[1],u[1],u[1]]),I=o.add(m(W,u[0]),[u[1],u[1],u[1],u[1]]),T=o.subtract(o.subtract(1,o.abs(E)),o.abs(I)),A=[E[0],E[1],I[0],I[1]],N=[E[2],E[3],I[2],I[3]],S=o.add(m(x(A),2),1),_=o.add(m(x(N),2),1),l=m(-1,M(T,[0,0,0,0])),w=o.add([A[0],A[2],A[1],A[3]],m([S[0],S[2],S[1],S[3]],[l[0],l[0],l[1],l[1]])),F=o.add([N[0],N[2],N[1],N[3]],m([_[0],_[2],_[1],_[3]],[l[2],l[2],l[3],l[3]])),B=[w[0],w[1],T[0]];h=[w[2],w[3],T[1]],d=[F[0],F[1],T[2]];let R=[F[2],F[3],T[3]],V=K([o.dot(B,B),o.dot(h,h),o.dot(d,d),o.dot(R,R)]);B=m(B,V[0]),h=m(h,V[1]),d=m(d,V[2]),R=m(R,V[3]);let b=o.max([o.subtract(.5,[o.dot(s,s),o.dot(y,y),o.dot(f,f),o.dot(g,g)]),[0,0,0,0]],0);return b=m(b,b),b=m(b,b),m(105,o.dot(b,[o.dot(B,s),o.dot(h,y),o.dot(d,f),o.dot(R,g)]))},pt=(t,n,e)=>{let r=0,s=1,c=1,a=0;for(let p=0;p<e;p++)r+=J(m(t,s))*c,a+=c,c*=n,s*=2;return r/a};import{Type as C,setComponent as L}from"@dojoengine/recs";import{poseidonHashMany as j}from"micro-starknet";import{byteArray as X,addAddressPadding as Y}from"starknet";var Z="0x1a2f334228cee715f1f0f54053bb6b5eac54fa336e0bc1aacf7516decb0471d",D="-";function gt(t){return t.events.filter(n=>n.keys.length===1&&n.keys[0]===Z)}function bt(t,n){n.forEach(e=>v(t,e.data))}function v(t,n){let e=tt(t);try{let r=ot(Array.from(e.keys()),n),s=t[e.get(r)],c=parseInt(n[1]),a=2+c+1,i=n.slice(2,2+c).map(d=>BigInt(d)),p=Q(i),y=parseInt(n[a]),f=i.map(d=>d.toString()),g=n.slice(a,a+y),h=nt(s,[...f,...g]);L(s,p,h)}catch(r){console.log(r)}}function tt(t){let n=new Map;for(let e of Object.keys(t)){let r=t[e];n.set(r.metadata?.name,e)}return n}function P(t,n){switch(n){case C.Boolean:return t!=="0x0";case C.Number:return Number(t);case C.BigInt:return BigInt(t);default:return t}}function nt(t,n){let e=t.schema,r=t.metadata?.types??[];return U(e,r,n,{types:0,values:0})}function U(t,n,e,r){return Object.keys(t).reduce((s,c)=>{let a=t[c];if(typeof a=="object")s[c]=U(a,n,e,r);else{if(s[c]=P(e[r.values],a),r.values++,n[r.types]==="u256"){let i=P(e[r.values],a);s[c]|=i<<128n,r.values++}r.types++}return s},{})}function xt(t){let n="";for(let e=2;e<t.length;e+=2)n+=String.fromCharCode(Number.parseInt(t.substr(e,2),16));return n}function Ct(t){let n="0x";for(let e=0;e<t.length;e++)n+=t.charCodeAt(e).toString(16).padStart(2,"0");return n}function ot(t,n){let e=t.reduce((c,a)=>{let i=at(a);return c[rt(i[0],i[1])]=a,c},{}),r=n[0],s=e[r];if(!s)throw new Error(`Action ${r} not found in actions : ${t}`);return s}function et(t){return"0x"+t.toString(16)}function rt(t,n){return et(j([G(t),G(n)]))}function st(t){return[BigInt(t.data.length),...t.data.map(e=>BigInt(e.toString())),BigInt(t.pending_word),BigInt(t.pending_word_len)]}function G(t){let n=X.byteArrayFromString(t);return j(st(n))}function at(t){return t.split(D)}function Q(t){let n=j(t);return Y("0x"+n.toString(16))}function Et(t,n){n.forEach(e=>{ct(t,e)})}function ct(t,n){let e=n.node.keys.map(s=>BigInt(s)),r=Q(e);n.node.models.forEach(s=>{let c=s.__typename,a=t[c];if(!a){console.error(`Component ${c} not found`);return}let i=Object.keys(a.schema).reduce((p,y)=>{let f=s[y],g=q(f,a.schema[y]);return p[y]=g,p},{});L(a,r,i)})}function q(t,n){if(t==null)return t;if(typeof n=="object"&&n!==null){let e={};for(let r in n)e[r]=q(t[r],n[r]);return e}switch(n){case C.Boolean:return!!t;case C.Number:return typeof t=="string"?0:isNaN(Number(t))?t:Number(t);case C.BigInt:return BigInt(t);default:return t}}function It(t,n=6){if(t?.length<=n)return t;let e=Math.floor(n/2),r=t.slice(0,e),s=t.slice(-e);return`${r}...${s}`}function it(t){switch(t){case"https:":return 443;case"wss:":return 443;default:return 80}}function Tt(t){try{let n=new URL(t),e=it(n.protocol),r=n.port||e,s=n.protocol.replace(":",""),c,a=n.hostname;a.match(/^\d+\.\d+\.\d+\.\d+$/)?c="ip4":a.startsWith("[")&&a.endsWith("]")?(c="ip6",a=a.slice(1,-1)):a.includes(":")?c="ip6":c="dns4";let i=`/${c}/${a}/tcp/${r}`;return["http","https"].includes(s)||(i+=`/${s==="wss"?"x-parity-wss":s}`),n.pathname&&n.pathname!=="/"&&(i+=`/${encodeURIComponent(n.pathname)}`),i}catch(n){return console.error("Invalid URI:",n),""}}export{Ct as asciiToHex,G as computeByteArrayHash,Tt as convertToRelayUri,nt as decodeComponent,ot as getComponentNameFromEvent,Q as getEntityIdFromKeys,gt as getEvents,rt as getSelectorFromTag,xt as hexToAscii,P as parseComponentValue,q as parseComponentValueFromGraphQLEntity,pt as recursiveSNoise,v as setComponentFromEvent,ct as setComponentFromGraphQLEntity,bt as setComponentsFromEvents,Et as setComponentsFromGraphQLEntities,It as shortenHex,J as snoise,at as splitEventTag};
//# sourceMappingURL=index.js.map